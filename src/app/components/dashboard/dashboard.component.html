<!-- Content wrapper -->
<div class="content-wrapper">
    <div class="card">
        <div class="container-xxl container-p-y">
            <div class="misc-wrapper">
        <div *ngIf="loading" class="loading-overlay">
        <div class="spinner"></div>
        </div>

        <div [class.blur]="loading">
          <div class="stats-container">
  <div class="stats-section">
    <div class="ticket-stats">
      <div class="stat-card" *ngFor="let stat of ticketOverAll">
        <h2>{{stat.title}}</h2>
        <div class="number">{{stat.count}}</div>
        <button class="view-details-btn" routerLink="/incident_report">View Incident Reports →</button>
      </div>
    </div>
  </div>

  <div class="stats-section">
    <div class="ticket-stats">
      <div class="stat-card" *ngFor="let stat of ticketStats">
        <h2>{{stat.title}}</h2>
        <div class="number">{{stat.count}}</div>
        <button class="view-details-btn" routerLink="/ticket_details">View Tickets →</button>
      </div>
    </div>
  </div>
</div>
              <!-- Incident Reports and Categories -->
              <div class="two-column">
                  <div class="column">
                      <div class="incident-header">
                          <h2>Incident Reports</h2>
                      </div>
                      
                      <table id="incident-table">
                          <thead>
                              <tr>
                                  <th>Ticket ID</th>
                                  <th>Incident</th>
                                  <th>Severity</th>
                              </tr>
                          </thead>
                          <tbody>
                              <tr *ngFor="let incident of filteredIncidents" [attr.data-severity]="incident.severity">
                                  <td>{{incident.IncID}}</td>
                                  <td>{{incident.incidentType}}</td>
                                  <td [class]="'severity-' + incident.severity">{{incident.severity | uppercase}}</td>
                              </tr>
                              <tr *ngIf="filteredIncidents.length === 0">
                                  <td colspan="3">No incidents to display</td>
                              </tr>
                          </tbody>
                      </table>
                      
                      <button class="view-details-btn full-width" routerLink="/incident_report">View All Incidents →</button>
                  </div>

                  <div class="column">
                    <h2>Categories</h2>
                
                    <div class="category-container">
                        <div class="category" *ngFor="let category of ticketCategories">
                            <div class="category-name">{{category.name}}</div>
                            <div class="category-bar-wrapper">
                                  <div class="category-bar">
                                  <div class="category-bar-fill" [style.width]="category.percentage + '%'"></div>
                                </div>
        
                            </div>
                        </div>
                    </div>
                
                    <button routerLink="/ticket_category" class="view-details-btn full-width">View All Categories →</button>
                </div>
              </div>

              <!-- Incident Timeline and Ticket Assignment -->
              <div class="two-column">
                  <!-- Incident Timeline -->
                  <div class="column incident-timeline">
                      <h2>Incident Timeline</h2>

                      <table class="timeline-table">
                          <thead>
                              <tr>
                                  <th>Ticket ID</th>
                                  <th>Event Time</th>
                              </tr>
                          </thead>
                          <tbody>
                              <tr *ngFor="let timeline of getLimitedTimeline()">
                                  <td>{{timeline.ticketId}}</td>
                                  <td>{{timeline.eventTime}}</td>
                              </tr>
                              <tr *ngIf="getLimitedTimeline().length === 0">
                                  <td colspan="2">No timeline events to display</td>
                              </tr>
                          </tbody>
                      </table>

                      <button class="view-details-btn full-width">View Full Timeline →</button>
                  </div>

                  <!-- Ticket Assignment -->
                  <div class="column ticket-assignment">
                      <h2>Ticket Assignment</h2>

                      <table class="assignment-table">
                          <thead>
                              <tr>
                                  <th>Assignment ID</th>
                                  <th>Ticket ID</th>
                                  <th>Assigned To</th>
                                  <th>Assigned Date</th>
                              </tr>
                          </thead>
                          <tbody>
                              <tr *ngFor="let assignment of getLimitedAssignments()">
                                  <td>{{assignment.assignmentId}}</td>
                                  <td>{{assignment.ticketId}}</td>
                                  <td>{{assignment.assignedTo}}</td>
                                  <td>{{assignment.assignedDate}}</td>
                              </tr>
                              <tr *ngIf="getLimitedAssignments().length === 0">
                                  <td colspan="4">No assignments to display</td>
                              </tr>
                          </tbody>
                      </table>

                      <button class="view-details-btn full-width">View All Assignments →</button>
                  </div>
              </div>

            </div>
        </div>
        </div>
    </div>
</div>